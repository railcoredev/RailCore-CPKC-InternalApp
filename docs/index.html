<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RailCore CPKC Worker App — v3.7</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- PWA hooks -->
    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#0b0f1a">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="railcore-icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="railcore-icon-512.png">

    <!-- RailCore styles -->
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="title">
                <span class="rc-title-orange">RAIL</span><span class="rc-title-gray">CORE</span>
            </div>
            <div class="subtitle">
                CPKC – CROSSING / SIDING / TRACK LENGTH WORKER APP
            </div>
        </div>

        <!-- MAIN PANEL -->
        <div class="panel">
            <!-- STATE(S) -->
            <label for="stateSelect">STATE(S)</label>
            <select id="stateSelect" multiple>
                <!-- filled by data_loader.js -->
            </select>

            <!-- SUBDIVISION -->
            <label for="subdivisionSelect">SUBDIVISION</label>
            <select id="subdivisionSelect">
                <!-- filled by app.js after state selection -->
            </select>

            <!-- EMERGENCY CONTACT -->
            <label>EMERGENCY CONTACT</label>
            <div id="emergencyContact">
                CPKC Emergency: <a href="tel:1-800-766-7912">1-800-766-7912</a>
            </div>

            <!-- SPACING + BUFFER -->
            <div class="flex-row">
                <div class="flex-col">
                    <label for="spacingInput">SPACING (FT)</label>
                    <input id="spacingInput" type="number" value="5500" min="0" step="100">
                </div>
                <div class="flex-col">
                    <label for="bufferInput">BUFFER (FT)</label>
                    <input id="bufferInput" type="number" value="400" min="0" step="50">
                </div>
            </div>

            <!-- VIEW MODE -->
            <div class="view-mode">
                <span>VIEW MODE</span><br>
                <label>
                    <input type="radio" name="viewMode" value="threshold" checked>
                    ≥ Threshold
                </label>
                <label>
                    <input type="radio" name="viewMode" value="all">
                    All
                </label>
            </div>

            <!-- ACTION BUTTONS -->
            <div class="button-row">
                <button id="applyBtn">Apply</button>
                <button id="printBtn" class="secondary">Print</button>
                <button id="downloadBtn" class="secondary">Download</button>
            </div>

            <!-- TAB BAR -->
            <div class="tab-bar">
                <div class="tab active" data-tab="crossings">Crossings</div>
                <div class="tab" data-tab="sidings">Sidings</div>
                <div class="tab" data-tab="tracklengths">Track Lengths</div>
            </div>

            <!-- TAB CONTENT AREAS -->
            <div id="crossingsTab" class="tab-content active">
                <div id="crossingsOutput" class="output-block">
                    Select state, subdivision, and spacing, then tap Apply.
                </div>
            </div>

            <div id="sidingsTab" class="tab-content">
                <div id="sidingsOutput" class="output-block">
                    Sidings view will show:
                    <br><br>
                    • Siding name and MP start–end with total length at top<br>
                    • Within each siding: MP start, distance to crossing(s) in feet,
                      crossing(s), distance to end, MP end.
                </div>
            </div>

            <div id="tracklengthsTab" class="tab-content">
                <label for="yardSelect">YARD</label>
                <select id="yardSelect">
                    <!-- filled by data_loader.js / app.js -->
                </select>
                <div id="trackLengthsOutput" class="output-block">
                    Track length view will list tracks for the selected yard.
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            RAILCORE CPKC WORKER APP — v3.7
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="data_loader.js"></script>
    <script src="app.js"></script>
    <script>
        // Register service worker for PWA + auto-update
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .catch(console.error);
        }
    </script>
</body>
</html>
