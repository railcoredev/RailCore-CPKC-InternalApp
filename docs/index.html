<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RAILCORE – CPKC Worker App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles/style.css" />

  <meta name="theme-color" content="#ff6600" />
</head>
<body>
  <div id="app-root" class="app-root">
    <!-- HEADER -->
    <header class="app-header">
      <div class="logo-row">
        <span class="logo-rail">RAIL</span><span class="logo-core">CORE</span>
      </div>
      <div class="header-subtitle">CPKC – INTERNAL WORKER TOOL</div>
    </header>

    <!-- MAIN APP AREA -->
    <main class="app-main">
      <section class="app-card">

        <!-- ========== STICKY CONTROL PANEL ========== -->
        <div class="controls-panel">
          <!-- STATE(S) DROPDOWN (future 50–state selector) + summary pill -->
          <div class="field-block">
            <div class="field-label">STATE(S)</div>
            <div class="field-row">
              <select id="stateSelect" class="pill-input pill-select">
                <!-- For now just a placeholder; future: all 50 states -->
                <option value="">All</option>
              </select>
              <!-- stateSummary kept for existing app.js logic -->
              <div id="stateSummary" class="pill-input pill-readonly">
                0 Items
              </div>
            </div>
          </div>

          <!-- SUBDIVISION DROPDOWN -->
          <div class="field-block">
            <div class="field-label">SUBDIVISION</div>
            <select id="subdivisionSelect" class="pill-input pill-select">
              <!-- Populated by app.js from SNAPSHOT.subdivisions -->
            </select>
          </div>

          <!-- SPACING + BUFFER + APPLY (single row, tight) -->
          <div class="field-row spacing-row">
            <div class="field-block compact">
              <div class="field-label">SPACING (FT)</div>
              <input
                id="spacingInput"
                class="pill-input pill-number"
                type="text"
                inputmode="numeric"
                pattern="\\d*"
                maxlength="5"
                value="5500"
              />
            </div>
            <div class="field-block compact">
              <div class="field-label">BUFFER (FT)</div>
              <input
                id="bufferInput"
                class="pill-input pill-number"
                type="text"
                inputmode="numeric"
                pattern="\\d*"
                maxlength="5"
                value="400"
              />
            </div>
            <button id="applyButton" class="btn btn-primary">Apply</button>
          </div>

          <!-- VIEW MODE + PRINT/DOWNLOAD -->
          <div class="field-row view-row">
            <div class="view-mode-group">
              <span class="view-label">View</span>
              <label class="radio-label">
                <input
                  type="radio"
                  name="viewMode"
                  value="threshold"
                  id="viewThreshold"
                  checked
                />
                <span>≥ Threshold</span>
              </label>
              <label class="radio-label">
                <input
                  type="radio"
                  name="viewMode"
                  value="all"
                  id="viewAll"
                />
                <span>All</span>
              </label>
            </div>
            <div class="actions-group">
              <button id="printButton" class="btn btn-secondary">Print</button>
              <button id="downloadButton" class="btn btn-secondary">Download</button>
            </div>
          </div>

          <!-- EMERGENCY LINE -->
          <div class="emergency-row">
            <div class="emergency-spacer"></div>
            <div class="emergency-text">
              CPKC Emergency:
              <a href="tel:1-800-766-7912">1-800-766-7912</a>
            </div>
          </div>

          <!-- TABS -->
          <nav class="tabs-row">
            <button
              class="tab-button active"
              data-tab="crossings"
              id="tabCrossings"
            >
              Crossings
            </button>
            <button
              class="tab-button"
              data-tab="sidings"
              id="tabSidings"
            >
              Sidings
            </button>
            <button
              class="tab-button"
              data-tab="tracks"
              id="tabTracks"
            >
              Track Lengths
            </button>
          </nav>
        </div>
        <!-- ========== END STICKY CONTROL PANEL ========== -->

        <!-- RESULTS AREA (fills remaining height, scrolls internally) -->
        <section class="results-panel">
          <!-- Yard dropdown (only used for Track Lengths tab) -->
          <div id="yardBlock" class="yard-block hidden">
            <div class="field-label">YARD</div>
            <select id="yardSelect" class="pill-input pill-select">
              <!-- Populated by app.js from SNAPSHOT.yards -->
            </select>
          </div>

          <pre id="resultsOutput" class="results-output">
Loading RailCore snapshot…
          </pre>
        </section>

        <!-- FOOTER (always at bottom of the card) -->
        <footer class="app-footer">
          RAILCORE CPKC WORKER APP · V3.8.1
        </footer>
      </section>
    </main>
  </div>

  <!-- DATA + APP LOGIC -->
  <script src="data_loader.js"></script>
  <script src="app.js"></script>
</body>
</html>
