<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RAILCORE – CPKC Worker App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles/style.css" />

  <meta name="theme-color" content="#ff6600" />
</head>
<body>
  <div id="app-root" class="app-root">
    <header class="app-header">
      <div class="logo-row">
        <span class="logo-rail">RAIL</span><span class="logo-core">CORE</span>
      </div>
      <div class="header-subtitle">CPKC – INTERNAL WORKER TOOL</div>
    </header>

    <main class="app-main">
      <section class="app-card">

        <!-- Sticky control panel -->
        <div class="controls-panel">
          <!-- States line (non-interactive for now) -->
          <div class="field-block">
            <div class="field-label">STATE(S)</div>
            <div id="stateSummary" class="pill-input pill-readonly">0 Items</div>
          </div>

          <!-- Subdivision selector -->
          <div class="field-block">
            <div class="field-label">SUBDIVISION</div>
            <select id="subdivisionSelect" class="pill-input pill-select">
              <!-- Populated by app.js -->
            </select>
          </div>

          <!-- Spacing / Buffer / Apply in one row -->
          <div class="field-row spacing-row">
            <div class="field-block compact">
              <div class="field-label">SPACING (FT)</div>
              <input
                id="spacingInput"
                class="pill-input pill-number"
                type="text"
                inputmode="numeric"
                pattern="\\d*"
                maxlength="5"
                value="5500"
              />
            </div>
            <div class="field-block compact">
              <div class="field-label">BUFFER (FT)</div>
              <input
                id="bufferInput"
                class="pill-input pill-number"
                type="text"
                inputmode="numeric"
                pattern="\\d*"
                maxlength="5"
                value="400"
              />
            </div>
            <button id="applyButton" class="btn btn-primary">Apply</button>
          </div>

          <!-- View mode / Print / Download -->
          <div class="field-row view-row">
            <div class="view-mode-group">
              <span class="view-label">View</span>
              <label class="radio-label">
                <input
                  type="radio"
                  name="viewMode"
                  value="threshold"
                  id="viewThreshold"
                  checked
                />
                <span>≥ Threshold</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="viewMode" value="all" id="viewAll" />
                <span>All</span>
              </label>
            </div>
            <div class="actions-group">
              <button id="printButton" class="btn btn-secondary">Print</button>
              <button id="downloadButton" class="btn btn-secondary">Download</button>
            </div>
          </div>

          <!-- Emergency contact at bottom-right of controls -->
          <div class="emergency-row">
            <div class="emergency-spacer"></div>
            <div class="emergency-text">
              CPKC Emergency:
              <a href="tel:1-800-766-7912">1-800-766-7912</a>
            </div>
          </div>

          <!-- Tabs -->
          <nav class="tabs-row">
            <button
              class="tab-button active"
              data-tab="crossings"
              id="tabCrossings"
            >
              Crossings
            </button>
            <button class="tab-button" data-tab="sidings" id="tabSidings">
              Sidings
            </button>
            <button
              class="tab-button"
              data-tab="tracks"
              id="tabTracks"
            >
              Track Lengths
            </button>
          </nav>
        </div>

        <!-- Results panel (scrolls when long) -->
        <section class="results-panel">
          <!-- Track-length yard dropdown (only shown on Track tab) -->
          <div id="yardBlock" class="yard-block hidden">
            <div class="field-label">YARD</div>
            <select id="yardSelect" class="pill-input pill-select">
              <!-- Populated by app.js -->
            </select>
          </div>

          <pre id="resultsOutput" class="results-output">
Loading RailCore snapshot…</pre>
        </section>

        <footer class="app-footer">
          RAILCORE CPKC WORKER APP · V3.8.1
        </footer>
      </section>
    </main>
  </div>

  <script src="data_loader.js"></script>
  <script src="app.js"></script>
</body>
</html>
